<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>æœ‰å£°å°è¯´App - æ²‰æµ¸æ¼«æ”¹ç‰ˆ</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <style>
        :root {
            --primary: #ff3b30;
            --bg-body: #f5f5f5;
            --card-bg: #ffffff;
            --text-main: #1c1c1e;
            --text-sub: #8e8e93;
            --nav-height: 80px;
        }

        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }

        body {
            margin: 0;
            font-family: -apple-system, BlinkMacSystemFont, "PingFang SC", "Helvetica Neue", Arial, sans-serif;
            background-color: #e0e0e0;
            height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            overflow: hidden;
        }

        /* æ‰‹æœºå®¹å™¨ */
        #app-shell {
            width: 100%;
            max-width: 414px; /* iPhone Pro Max å®½åº¦ */
            height: 100%;
            max-height: 896px;
            background-color: var(--bg-body);
            position: relative;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            box-shadow: 0 0 40px rgba(0,0,0,0.2);
            border-radius: 0; 
        }
        
        /* åœ¨æ¡Œé¢ç«¯æ˜¾ç¤ºåœ†è§’æ¨¡æ‹Ÿæ‰‹æœº */
        @media (min-width: 450px) {
            #app-shell {
                height: 90vh;
                border-radius: 40px;
                border: 8px solid #333;
            }
        }

        /* --- é¦–é¡µéƒ¨åˆ† --- */
        .home-container { flex: 1; overflow-y: auto; padding-bottom: 50px; }
        
        /* é¡¶éƒ¨æœç´¢åŒº */
        .header { padding: 8px 16px 0; background: #fff; position: sticky; top: 0; z-index: 10; }
        .search-bar { background: #f5f5f5; height: 32px; border-radius: 16px; display: flex; align-items: center; padding: 0 12px; color: #999; font-size: 13px; margin-bottom: 6px; }
        
        /* æ ‡ç­¾å¯¼èˆªæ  */
        .nav-tabs { display: flex; gap: 0; padding: 0 16px 6px; background: #fff; overflow-x: auto; scrollbar-width: none; }
        .nav-tabs::-webkit-scrollbar { display: none; }
        .nav-tab { flex-shrink: 0; padding: 6px 12px; font-size: 15px; color: #333; position: relative; white-space: nowrap; }
        .nav-tab.active { color: #333; font-weight: bold; }
        .nav-tab.active::after { content: ''; position: absolute; bottom: 0; left: 50%; transform: translateX(-50%); width: 20px; height: 3px; background: var(--primary); border-radius: 2px; }
        .nav-badge { display: inline-block; width: 8px; height: 8px; background: var(--primary); border-radius: 50%; margin-left: 4px; vertical-align: top; }
        
        /* æœ¬å‘¨æ”¶å¬ç»Ÿè®¡åŒºåŸŸ */
        .ai-guide { padding: 8px 16px 6px; background: #fff; display: flex; justify-content: space-between; align-items: center; }
        .ai-guide-text { font-size: 13px; color: #333; font-weight: 500; }
        .vip-promotion { font-size: 11px; color: var(--primary); background: rgba(255,59,48,0.1); padding: 4px 8px; border-radius: 12px; }
        
        /* æ¨ªå¹…åŒºåŸŸ */
        .banner-section { padding: 0 16px 6px; background: #fff; }
        .banner-title { font-size: 14px; color: #333; margin-bottom: 6px; }
        .banner-title .vip-tag { font-size: 10px; color: var(--primary); background: rgba(255,59,48,0.1); padding: 2px 6px; border-radius: 4px; margin-left: 8px; }
        
        /* æ¨ªå‘æ»‘åŠ¨å¡ç‰‡ - 3:4æ¯”ä¾‹ */
        .horizontal-cards { display: flex; gap: 10px; overflow-x: auto; scrollbar-width: none; padding-bottom: 6px; }
        .horizontal-cards::-webkit-scrollbar { display: none; }
        .h-card { flex-shrink: 0; width: 100px; height: 133px; border-radius: 8px; overflow: hidden; position: relative; background-size: cover; background-position: center; cursor: pointer; }
        .h-card-overlay { position: absolute; bottom: 0; left: 0; right: 0; padding: 8px; background: linear-gradient(to top, rgba(0,0,0,0.7), rgba(0,0,0,0.3), transparent); color: #fff; }
        .h-card-title { font-size: 10px; font-weight: bold; margin-bottom: 4px; line-height: 1.3; }
        .h-card-subtitle { font-size: 9px; opacity: 0.9; }
        .h-card-btn { background: var(--primary); color: #fff; border: none; padding: 4px 8px; border-radius: 8px; font-size: 9px; cursor: pointer; white-space: nowrap; }
        
        /* æ¨èåŒºåŸŸ */
        .recommend-section { padding: 8px 16px; }
        .section-title { font-size: 16px; font-weight: bold; color: #333; margin-bottom: 6px; display: flex; align-items: center; justify-content: space-between; }
        .section-more { font-size: 12px; color: #999; }
        
        /* åˆ—è¡¨å¡ç‰‡å®¹å™¨ */
        #list-cards { margin-bottom: 8px; }
        
        /* åŒåˆ—å¡ç‰‡å¸ƒå±€ */
        .feed-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; }
        .grid-card { background: #fff; border-radius: 12px; overflow: hidden; cursor: pointer; display: flex; flex-direction: column; }
        .grid-card:active { opacity: 0.8; }
        .grid-card-cover { width: 100%; aspect-ratio: 3/4; background-size: cover; background-position: center; position: relative; }
        .card-badge { position: absolute; top: 6px; right: 6px; background: rgba(0,0,0,0.5); color: #fff; font-size: 9px; padding: 2px 6px; border-radius: 4px; }
        .grid-card-info { padding: 8px; flex: 1; display: flex; flex-direction: column; }
        .grid-card-title { font-size: 14px; font-weight: 500; color: #333; margin-bottom: 6px; line-height: 1.4; flex-grow: 1; }
        .grid-card-meta { font-size: 11px; color: #999; }
        .grid-card-tags { display: flex; gap: 4px; flex-wrap: nowrap; overflow: hidden; margin-bottom: 6px; }
        .grid-tag { font-size: 10px; background: #f5f5f5; padding: 2px 6px; border-radius: 4px; color: #666; flex-shrink: 0; white-space: nowrap; }
        
        /* å¤§å‹æ¨ªå¹…å¹¿å‘Š */
        .large-banner { margin-top: 16px; display: flex; gap: 10px; }
        .large-banner-item { flex: 1; height: 180px; border-radius: 12px; background-size: cover; background-position: center; cursor: pointer; }
        
        /* åˆ—è¡¨å¡ç‰‡ï¼ˆå•åˆ—ï¼‰ */
        .list-card { display: flex; gap: 8px; background: #fff; padding: 8px; margin-bottom: 6px; cursor: pointer; border-radius: 8px; }
        .list-card-cover { width: 60px; height: 60px; border-radius: 6px; background-size: cover; background-position: center; flex-shrink: 0; }
        .list-card-info { flex: 1; display: flex; flex-direction: column; justify-content: space-between; }
        .list-card-title { font-size: 13px; font-weight: 500; color: #333; margin-bottom: 2px; }
        .list-card-desc { font-size: 11px; color: #999; line-height: 1.3; }
        .list-card-badge { font-size: 9px; color: var(--primary); border: 1px solid var(--primary); padding: 2px 6px; border-radius: 4px; align-self: flex-start; }

        /* --- æ²‰æµ¸å¼æ’­æ”¾å™¨ (Immersive Player) --- */
        .immersive-player {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: #1a1a1a;
            z-index: 100;
            transform: translateY(100%); /* é»˜è®¤éšè— */
            transition: transform 0.4s cubic-bezier(0.2, 0.8, 0.2, 1);
            display: flex;
            flex-direction: column;
            color: #fff;
        }
        .immersive-player.active { transform: translateY(0); }

        /* 1. é¡¶éƒ¨ï¼šAIæ¼«ç”»è½®æ’­åŒº */
        .visual-area {
            position: relative;
            width: 100%;
            height: 55%; /* å æ®ä¸ŠåŠéƒ¨åˆ† */
            overflow: hidden;
        }
        
        .carousel-track {
            display: flex;
            width: 100%;
            height: 100%;
            transition: transform 0.5s ease;
        }
        
        .carousel-item {
            min-width: 100%;
            height: 100%;
            background-size: cover;
            background-position: center;
            position: relative;
        }
        
        /* æ¼«ç”»é£æ ¼æ»¤é•œ */
        .comic-filter {
            filter: contrast(1.1) saturate(1.2); 
        }
        .comic-filter::after {
            content: ''; position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            background: linear-gradient(to bottom, transparent 60%, #1a1a1a 100%);
        }

        /* é¡¶éƒ¨è¿”å›ä¸æ ‡é¢˜ */
        .player-top-bar {
            position: absolute;
            top: 40px;
            left: 0;
            width: 100%;
            padding: 0 16px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            z-index: 20;
            text-shadow: 0 2px 4px rgba(0,0,0,0.5);
        }
        .p-back { font-size: 20px; width: 32px; height: 32px; background:rgba(0,0,0,0.3); border-radius:50%; display:flex; align-items:center; justify-content:center; backdrop-filter: blur(4px); }
        .p-book-title { font-weight: bold; font-size: 16px; }

        /* æ–°ï¼šæ²‰æµ¸é¡µåº•éƒ¨ä¿¡æ¯æµ®å±‚ */
        .player-bottom-overlay {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            padding: 12px 16px 30px; /* é€‚é…åº•éƒ¨å®‰å…¨åŒº */
            background: linear-gradient(to top, rgba(0,0,0,0.95) 20%, rgba(0,0,0,0.7) 70%, transparent 100%);
            color: #fff;
        }

        .p-tags {
            display: flex;
            gap: 8px;
            margin-bottom: 16px;
            padding-bottom: 4px;
            overflow-x: auto;
            scrollbar-width: none; /* Firefox */
        }
        .p-tags::-webkit-scrollbar { display: none; } /* Chrome, Safari */

        .p-tag-item {
            background: rgba(255,255,255,0.15);
            border: 1px solid rgba(255,255,255,0.2);
            padding: 6px 12px;
            border-radius: 16px;
            font-size: 12px;
            white-space: nowrap;
            cursor: pointer;
            transition: background 0.2s;
        }
        .p-tag-item:hover { background: rgba(255,255,255,0.3); }

        .p-album-info {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .p-album-cover {
            width: 48px;
            height: 48px;
            border-radius: 6px;
            object-fit: cover;
            flex-shrink: 0;
        }

        .p-album-details {
            flex: 1;
            min-width: 0; /* é˜²æ­¢æ–‡æœ¬è¿‡é•¿æ’‘å¼€å¸ƒå±€ */
        }

        .p-album-title {
            font-size: 16px;
            font-weight: bold;
            margin-bottom: 4px;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .p-album-progress {
            font-size: 12px;
            color: #aaa;
        }

        .p-listen-full {
            background: var(--primary);
            color: #fff;
            border: none;
            padding: 10px 16px;
            border-radius: 20px;
            font-size: 13px;
            font-weight: bold;
            white-space: nowrap;
            cursor: pointer;
        }

        /* --- æ–°ï¼šæ²‰æµ¸å¼æ’­æ”¾å™¨ V2 --- */
        .immersive-player .top-nav-bar {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            padding: 50px 16px 10px;
            z-index: 110;
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: linear-gradient(to bottom, rgba(0,0,0,0.4), transparent);
        }
        
        .immersive-player .back-btn {
            font-size: 20px;
            color: #fff;
            cursor: pointer;
        }

        .immersive-player .tab-switcher {
            display: flex;
            background: rgba(255,255,255,0.2);
            border-radius: 18px;
            padding: 2px;
            backdrop-filter: blur(8px);
        }
        
        .immersive-player .switcher-btn {
            padding: 6px 16px;
            border-radius: 16px;
            font-size: 13px;
            font-weight: bold;
            color: #fff;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.25, 0.8, 0.25, 1);
        }

        .immersive-player .switcher-btn.active {
            background: #fff;
            color: #111;
            box-shadow: 0 2px 8px rgba(0,0,0,0.2);
        }

        .immersive-player .content-panel {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 100;
            transition: opacity 0.4s ease, visibility 0.4s;
        }

        .immersive-player .content-panel:not(.active) {
            opacity: 0;
            visibility: hidden;
        }
        
        #highlights-panel {
            display: flex;
            flex-direction: column;
            color: #fff;
        }

        #highlights-panel-content {
            flex: 1;
            overflow: hidden; /* Changed from auto */
            position: relative;
            display: flex;
            padding: 0; /* Remove padding */
        }

        .highlight-carousel-track {
            display: flex;
            height: 100%;
            transition: transform 0.5s cubic-bezier(0.25, 0.46, 0.45, 0.94);
        }

        .highlight-slide {
            width: 100vw; /* Use viewport width */
            height: 100%;
            flex-shrink: 0;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            padding: 120px 24px 80px; /* Top, sides, bottom padding */
            text-align: center;
        }

        .highlight-slide .slide-tag {
            background: rgba(0,0,0,0.2);
            color: #fff;
            padding: 6px 14px;
            border-radius: 16px;
            font-size: 13px;
            font-weight: bold;
            margin-bottom: 24px;
        }

        .highlight-slide .slide-title {
            font-size: 28px;
            font-weight: bold;
            color: #fff;
            margin-bottom: 32px;
            line-height: 1.4;
        }

        .highlight-slide .slide-review-card {
            background: rgba(0,0,0,0.15);
            border: 1px solid rgba(255,255,255,0.1);
            backdrop-filter: blur(12px);
            border-radius: 16px;
            padding: 20px;
            width: 100%;
            max-width: 380px;
        }

        .highlight-slide .review-author {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 12px;
        }
        .highlight-slide .review-author .avatar {
            font-size: 24px;
        }
        .highlight-slide .review-author .username {
            font-size: 13px;
            color: #ccc;
        }

        .highlight-slide .review-text {
            font-size: 16px;
            line-height: 1.6;
            color: #fff;
        }

        .carousel-dots {
            position: absolute;
            bottom: 60px; /* Adjust to be above bottom bar space */
            left: 50%;
            transform: translateX(-50%);
            display: flex;
            gap: 8px;
            z-index: 120;
        }

        .carousel-dots .dot {
            width: 6px;
            height: 6px;
            background: rgba(255,255,255,0.3);
            border-radius: 50%;
            transition: all 0.3s;
        }
        .carousel-dots .dot.active {
            background: #fff;
            transform: scale(1.2);
        }
        
        /* æ›´æ–°ï¼šå¸¸é©»åº•éƒ¨ä¿¡æ¯æ æ ·å¼ */
        .player-bottom-bar {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            padding: 16px 16px 30px; /* é€‚é…å®‰å…¨åŒº */
            background: linear-gradient(to top, rgba(0,0,0,0.95) 30%, rgba(0,0,0,0.7) 80%, transparent 100%);
            z-index: 115; /* é«˜äºå†…å®¹é¢æ¿ï¼Œä½äºè½®æ’­ç‚¹ */
            color: #fff;
        }

        .player-bottom-bar .info-tags {
            display: flex;
            gap: 8px;
            margin-bottom: 12px;
        }
        .player-bottom-bar .info-tag {
            font-size: 11px;
            padding: 4px 8px;
            background: rgba(255,255,255,0.15);
            border-radius: 12px;
            white-space: nowrap;
        }

        .player-bottom-bar .main-info {
            display: flex;
            gap: 12px;
            margin-bottom: 12px;
        }
        .main-info .album-cover {
            width: 60px;
            height: 60px;
            border-radius: 8px;
            object-fit: cover;
            flex-shrink: 0;
        }
        .main-info .album-details .title {
            font-size: 18px;
            font-weight: bold;
            margin-bottom: 4px;
        }
        .main-info .album-details .description {
            font-size: 12px;
            color: #ccc;
            line-height: 1.5;
        }

        .player-bottom-bar .progress-cta {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .progress-cta .progress-text {
            font-size: 13px;
            color: #aaa;
        }
        
        /* è§†é¢‘æ§åˆ¶æŒ‰é’® */
        .video-controls button {
            transition: all 0.3s ease;
        }
        .video-controls button:hover {
            background: rgba(0,0,0,0.7) !important;
            transform: scale(1.1);
        }

        /* 3. åº•éƒ¨ï¼šæ§åˆ¶æ¡ä¸ç•…å¬æŒ‰é’® */
        .control-dock {
            background: #252525;
            padding: 16px 20px 30px; /* é€‚é…åº•éƒ¨å®‰å…¨åŒº */
            border-top: 1px solid rgba(255,255,255,0.05);
        }

        /* è¿›åº¦æ¡ */
        .prog-row { display: flex; align-items: center; gap: 10px; font-size: 10px; color: #888; margin-bottom: 14px; }
        .prog-bar { flex: 1; height: 3px; background: #444; border-radius: 2px; position: relative; }
        .prog-fill { width: 30%; height: 100%; background: var(--primary); border-radius: 2px; position: relative; }
        .prog-fill::after { content:''; width:8px; height:8px; background:#fff; border-radius:50%; position:absolute; right:-4px; top:-2.5px; box-shadow: 0 0 4px rgba(0,0,0,0.5); }

        /* æ§åˆ¶æŒ‰é’®è¡Œ */
        .ctrl-row {
            display: flex;
            align-items: center;
            justify-content: space-between;
        }
        .play-btns { display: flex; align-items: center; gap: 20px; }
        .btn-icon { font-size: 20px; color: #ddd; }
        .btn-play { font-size: 36px; color: #fff; }

        /* ç•…å¬å…¨é›†æŒ‰é’® */
        .jump-album-btn {
            background: linear-gradient(90deg, #ff3b30, #ff9500);
            border: none;
            color: #fff;
            padding: 10px 16px;
            border-radius: 24px;
            font-size: 13px;
            font-weight: bold;
            display: flex;
            align-items: center;
            gap: 6px;
            box-shadow: 0 4px 12px rgba(255, 59, 48, 0.3);
            animation: pulse 2s infinite;
        }
        @keyframes pulse { 0% { transform: scale(1); } 50% { transform: scale(1.02); } 100% { transform: scale(1); } }

        /* æ‚¬æµ®åˆ‡æ¢æŒ‰é’® */
        .switch-mode-btn {
            position: absolute;
            top: 50%;
            right: 10px;
            z-index: 50;
            background: rgba(0,0,0,0.6);
            color: #fff;
            border-radius: 20px;
            padding: 6px 12px;
            font-size: 12px;
            display: flex;
            align-items: center;
            gap: 4px;
            backdrop-filter: blur(4px);
            border: 1px solid rgba(255,255,255,0.2);
        }

    </style>
</head>
<body>

<div id="app-shell">
    <!-- é¦–é¡µ -->
    <div class="home-container">
        <!-- é¡¶éƒ¨æœç´¢æ  -->
        <div class="header">
            <div class="search-bar"><i class="fas fa-search" style="margin-right:8px;"></i> ä¹¦ç±</div>
            <div class="nav-tabs">
                <div class="nav-tab">ç›´æ’­<span class="nav-badge"></span></div>
                <div class="nav-tab active">æ¨è</div>
                <div class="nav-tab">è§£å¿§è·¯</div>
                <div class="nav-tab">å°è¯´</div>
                <div class="nav-tab">å„¿ç«¥</div>
                <div class="nav-tab">ç›¸å£°</div>
                <div class="nav-tab">æ®µå­</div>
            </div>
        </div>
        
        <!-- æœ¬å‘¨æ”¶å¬ç»Ÿè®¡ -->
        <div class="ai-guide">
            <div class="ai-guide-text">æœ¬å‘¨å·²æ”¶å¬3åˆ†é’Ÿ <i class="fas fa-chevron-right" style="font-size:12px; margin-left:4px;"></i></div>
            <div class="vip-promotion">VIP ç»­è´¹ä»…éœ€0.32å…ƒ/å¤©</div>
        </div>
        
        <!-- æ¨ªå‘å¡ç‰‡åŒºåŸŸï¼ˆ3:4æ¯”ä¾‹ï¼‰ -->
        <div class="banner-section">
            <div class="horizontal-cards">
                <!-- Card 1: VIPä¼šå‘˜å¡ç‰‡ - ç²‰çº¢è‰²æ¸å˜ -->
                <div class="h-card" style="background: linear-gradient(135deg, #d4928b 0%, #c8827b 100%);">
                    <div style="padding:10px; height:100%; display:flex; flex-direction:column; justify-content:space-between;">
                        <div>
                            <div style="background:#b8756f; width:fit-content; padding:3px 6px; border-radius:4px; margin-bottom:6px;">
                                <span style="color:#fff; font-size:8px;">å–œé©¬æ‹‰é›…VIPä¼šå‘˜</span>
                            </div>
                            <div style="font-size:10px; font-weight:bold; color:#333; line-height:1.3;">æ”¶å¬é¢†å¥– | æœ€<br>é«˜åŠ èµ 10å¤©VIP</div>
                        </div>
                        <button class="h-card-btn" style="padding:4px 8px; font-size:9px; background:#fff; color:#d4928b; font-weight:bold;">ç«‹å³å‚ä¸</button>
                    </div>
                </div>
                
                <!-- Card 2: å–œé©¬å¿«å¬ - è“ç»¿è‰²æ¸å˜ -->
                <div class="h-card" style="background: linear-gradient(135deg, #7ba8a8 0%, #6b9999 100%); position:relative;">
                    <div style="position:absolute; top:6px; right:6px;">
                        <div style="background:#5a8a8a; padding:2px 6px; border-radius:4px;">
                            <span style="color:#fff; font-size:8px;">ç§è‰</span>
                        </div>
                    </div>
                    <div style="padding:10px; height:100%; display:flex; flex-direction:column; justify-content:flex-end;">
                        <div style="font-size:10px; font-weight:bold; color:#fff; margin-bottom:4px; line-height:1.3;">å–œé©¬å¿«å¬ | ç»<br>å®‹èµ·ç‚¹ç©¿è¶Š...</div>
                        <div style="display:flex; align-items:center; gap:4px;">
                            <i class="fas fa-play-circle" style="font-size:10px; color:#fff;"></i>
                            <button class="h-card-btn" style="padding:3px 8px; font-size:9px; background:rgba(255,255,255,0.9); color:#7ba8a8;">å‰©1åˆ†é’Ÿ</button>
                        </div>
                    </div>
                </div>
                
                <!-- Card 3: è®¢é˜… - æ·±è“ç°è‰²æ¸å˜ -->
                <div class="h-card" style="background: linear-gradient(135deg, #5a6b7a 0%, #4a5a6a 100%); position:relative;">
                    <div style="position:absolute; top:6px; right:6px;">
                        <div style="background:rgba(255,255,255,0.9); padding:2px 6px; border-radius:4px;">
                            <span style="color:#333; font-size:8px;">è®¢é˜…</span>
                        </div>
                    </div>
                    <div style="padding:10px; height:100%; display:flex; flex-direction:column; justify-content:flex-end;">
                        <div style="font-size:10px; font-weight:bold; color:#fff; margin-bottom:4px; line-height:1.3;">è®¢é˜… | Vol.169<br>åœ¨ç‰ˆçº³å’Œæ™®...</div>
                        <div style="display:flex; align-items:center; gap:4px;">
                            <i class="fas fa-play-circle" style="font-size:10px; color:#fff;"></i>
                            <button class="h-card-btn" style="padding:3px 8px; font-size:9px; background:rgba(255,255,255,0.9); color:#5a6b7a;">ç«‹å³æ”¶å¬</button>
                        </div>
                    </div>
                </div>
                
                <!-- Card 4: ä½ ç¨€ - é»„è‰²æ¸å˜ -->
                <div class="h-card" style="background: linear-gradient(135deg, #d4c48a 0%, #c8b87a 100%); position:relative;">
                    <div style="position:absolute; top:8px; right:8px; font-size:14px;">âœ¨</div>
                    <div style="padding:10px; height:100%; display:flex; flex-direction:column; justify-content:center; align-items:center;">
                        <div style="font-size:16px; font-weight:bold; color:#333; text-align:center; margin-bottom:8px;">ä½ ç¨€</div>
                        <div style="font-size:8px; color:#666; text-align:center;">ç¨€å¥‡å¤æ€ª</div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- ä½ çš„ä¸“å±æ¨è -->
        <div class="recommend-section">
            <div class="section-title">
                ä½ çš„ä¸“å±æ¨è
                <span class="section-more"><i class="fas fa-ellipsis-h"></i></span>
            </div>
            
            <!-- åˆ—è¡¨å¡ç‰‡åŒºåŸŸ -->
            <div id="list-cards">
                <!-- JSç”Ÿæˆ -->
            </div>
            
            <!-- åŒåˆ—å¡ç‰‡åŒºåŸŸ -->
            <div class="feed-grid" id="feed-grid">
                <!-- JSç”Ÿæˆå¡ç‰‡ -->
            </div>
            
        </div>
    </div>

    <!-- åº•éƒ¨å¯¼èˆª -->
    <div style="position:absolute; bottom:0; width:100%; height:50px; background:#fff; display:flex; justify-content:space-around; align-items:center; border-top:1px solid #eee; z-index:10;">
        <div style="color:var(--primary); display:flex; flex-direction:column; align-items:center; gap:4px;">
            <i class="fas fa-home" style="font-size:22px;"></i>
            <span style="font-size:10px;">é¦–é¡µ</span>
        </div>
        <div style="display:flex; flex-direction:column; align-items:center; gap:4px; color:#999;">
            <i class="fas fa-headphones" style="font-size:22px;"></i>
            <span style="font-size:10px;">å¿«å¬</span>
        </div>
        <div style="display:flex; flex-direction:column; align-items:center; gap:4px; color:#999; position:relative;">
            <i class="fas fa-play-circle" style="font-size:32px;"></i>
        </div>
        <div style="display:flex; flex-direction:column; align-items:center; gap:4px; color:#999;">
            <i class="fas fa-crown" style="font-size:22px;"></i>
            <span style="font-size:10px;">ä¼šå‘˜</span>
        </div>
        <div style="display:flex; flex-direction:column; align-items:center; gap:4px; color:#999;">
            <i class="fas fa-user" style="font-size:22px;"></i>
            <span style="font-size:10px;">æˆ‘çš„</span>
        </div>
    </div>

    <!-- æ²‰æµ¸å¼æ’­æ”¾å™¨å±‚ -->
    <div class="immersive-player" id="player">
        
        <!-- æ–°ï¼šé¡¶éƒ¨å¯¼èˆªæ  -->
        <div class="top-nav-bar">
            <span class="back-btn" onclick="closePlayer()"><i class="fas fa-chevron-down"></i></span>
            <div class="tab-switcher">
                <div id="tab-video" class="switcher-btn active" onclick="switchImmersiveTab('video')">è§†é¢‘</div>
                <div id="tab-highlights" class="switcher-btn" onclick="switchImmersiveTab('highlights')">äº®ç‚¹</div>
            </div>
            <span style="width: 20px;"></span> <!-- å ä½ç¬¦ï¼Œä¸ºäº†è®©tabå±…ä¸­ -->
        </div>

        <!-- å†…å®¹é¢æ¿ -->
        <div id="video-panel" class="content-panel active">
            <video id="immersive-video" style="width: 100%; height: 100%; object-fit: cover;" autoplay muted loop>
                <source src="" type="video/mp4">
            </video>
        </div>

        <div id="highlights-panel" class="content-panel">
            <div id="highlights-panel-content" class="highlight-carousel-track">
                <!-- JSåŠ¨æ€å¡«å……ç»“æ„åŒ–äº®ç‚¹ -->
            </div>
            <div class="carousel-dots" id="highlights-carousel-dots">
                <!-- JSåŠ¨æ€å¡«å……åˆ†é¡µç‚¹ -->
            </div>
        </div>

        <!-- æ›´æ–°ï¼šå¸¸é©»åº•éƒ¨ä¿¡æ¯æ  -->
        <div class="player-bottom-bar">
            <div id="player-bar-tags" class="info-tags">
                <!-- JS Populated -->
            </div>
            <div class="main-info">
                <img id="player-bar-cover" class="album-cover" src="">
                <div class="album-details">
                    <div id="player-bar-title" class="title"></div>
                    <div id="player-bar-desc" class="description"></div>
                </div>
            </div>
            <div class="progress-cta">
                <div id="player-bar-progress" class="progress-text"></div>
                <button class="p-listen-full" onclick="goToAlbum()">ç•…å¬å…¨é›†</button>
            </div>
        </div>
    </div>

    <!-- æ—§çš„äº®ç‚¹è¯¦æƒ…é¡µ (ä¸å†ä½¿ç”¨) -->
    <div id="highlights-view" style="display: none;"></div>

</div>

<script>
    // ä¹¦ç±æ•°æ®ï¼ŒåŒ…å«ç”·é’å¹´ç”»åƒå†…å®¹
    const books = [
        {
            id: 1,
            persona: 'male-youth',
            title: "è¯¡ç§˜ä¹‹ä¸»ï½œè¿™ä¸–ç•Œæ¯” RPG æ›´ç¡¬æ ¸ï¼Œè®°ä½ä½ åªæ˜¯åœ¨æ‰®æ¼”",
            author: "çˆ±æ½œæ°´çš„ä¹Œè´¼",
            tags: ["é€»è¾‘çˆ†å¼ºä¸–ç•Œè§‚", "åå·®é­…åŠ›ä¸»è§’"],
            description: "22æ¡ç¥ä¹‹é€”å¾„ï¼Œ220ç§é­”è¯ï¼Œæ™‹å‡åºåˆ—ï¼Œæ‰®æ¼”è§’è‰²ï¼Œåœ¨æˆç¥ä¹‹è·¯ä¸Šå¯¹æŠ—ç–¯ç‹‚ä¸è¯±æƒ‘ã€‚",
            cover: "ç”·é’å¹´å°é¢.png",
            plays: "1.2äº¿",
            badge: "ä¼šå‘˜",
            ranking: "VIPæ¦œNo.1",
            videoFile: "ç”·é’å¹´-è§†é¢‘.mp4",
            albumTitle: "è¯¡ç§˜ä¹‹ä¸»",
            episodes: 1488,
            themeColor: "#1c2a4f",
            highlights: [
                {
                    title: "é€»è¾‘çˆ†å¼ºä¸–ç•Œè§‚ï¼ˆç”·é’å¹´æœ€çˆ±ï¼‰",
                    tag: "ä¸–ç•Œè§‚ç¡¬æ ¸",
                    description: "ç”·é’å¹´ç‰¹åˆ«åƒâ€œé€»è¾‘ä¸¥å¯†çš„ç³»ç»Ÿâ€ã€‚è¯¡ç§˜çš„è®¾å®šåƒæ•°å­¦å…¬å¼ä¸€æ ·èƒ½è‡ªæ´½ï¼Œå¤æ‚ä½†æœ‰ç§©åºï¼Œè¶Šå¬è¶Šæ²‰æµ¸ã€‚",
                    reviews: [
                        { avatar: "ğŸ‘¤", user: "ç”¨æˆ·_9527", content: "å‰§æƒ…ç¯ç¯ç›¸æ‰£ã€é€»è¾‘æ¸…æ™°ã€‚", likes: 1247 },
                        { avatar: "ğŸ‘¤", user: "é€»è¾‘æ§", content: "ä¸–ç•Œè§‚ç¼”é€ å¾ˆæœ‰ç”»é¢æ„Ÿï¼Œéå¸¸æœ‰ä»£å…¥æ„Ÿã€‚", likes: 892 },
                        { avatar: "ğŸ‘¤", user: "ä¹¦è™«å°ç‹", content: "ç»“æ„å®å¤§äº•ç„¶æœ‰åºâ€¦ä¸€è·¯è¯»ä¸‹æ¥æ¸å…¥ä½³å¢ƒæ¬²ç½¢ä¸èƒ½ã€‚", likes: 2156 },
                        { avatar: "ğŸ‘¤", user: "ç½‘æ–‡çˆ±å¥½è€…", content: "ä¸€éƒ¨ç½‘æ–‡ï¼Œæ‹¥æœ‰è¿™æ ·åºå¤§ä¸”å®Œæ•´çš„ä¸–ç•Œè§‚ã€æ‹¥æœ‰ç‹¬ç‰¹çš„å®Œæ•´çš„ä½“ç³»ã€‚", likes: 1789 }
                    ]
                },
                {
                    title: "åå·®é­…åŠ›ä¸»è§’ï¼ˆæ€‚ä½†èƒ½æ‰›ï¼‰",
                    tag: "ä¸»è§’é­…åŠ›",
                    description: "ç”·é’å¹´å–œæ¬¢â€œæ™®é€šä½†åŠªåŠ›â€â€œå®³æ€•ä½†ä¸é€ƒâ€çš„ä¸»è§’ã€‚ä»–è°¨æ…ã€èªæ˜ã€æœ‰åº•çº¿ï¼Œæ˜¯æœ€å…·ç°å®æ„Ÿçš„ç”·æ€§è§’è‰²ã€‚",
                    reviews: [
                        { avatar: "ğŸ‘¤", user: "å…‹è±æ©ç²‰", content: "çœŸæ­£çš„ç°è±¡çº§å°è¯´â€¦å…‹è±æ©æ˜¯ä¸€ä¸ªä¸‰è§‚å¾ˆæ­£â€¦é¡ºç†æˆç« ä¸åœ£æ¯ã€‚", likes: 3421 },
                        { avatar: "ğŸ‘¤", user: "ç”·ä¸»æ§", content: "ä¸»è§’æ€§æ ¼ä¹Ÿå¾ˆæ£’ï¼Œä¸åœ£æ¯ä¹Ÿä¸æ— è„‘æ€æˆ®ï¼Œæœ‰å°æˆ‘ä¹Ÿæœ‰å¤§çˆ±ã€‚", likes: 2567 },
                        { avatar: "ğŸ‘¤", user: "ç°å®ä¸»ä¹‰", content: "æ€•æ­»æ€•ç–¼ä½†å‹‡æ•¢â€¦å°Šé‡å¥³æ€§ï¼Œæ¸©æŸ”å–„è‰¯ä½†ä¸æ„šå–„ã€‚", likes: 1893 },
                        { avatar: "ğŸ‘¤", user: "è§’è‰²åˆ†æå¸ˆ", content: "å“ªæ€•æ€‚å´æœ‰æ‹…å½“ï¼ŒåšæŒç€è‡ªå·±åˆ¶å®šçš„åŸåˆ™ã€‚", likes: 2234 }
                    ]
                },
                {
                    title: "æ™ºåŠ›çˆ½æ„Ÿï¼ˆæ¨ç†ã€ç»†èŠ‚ã€ä¼ç¬”ï¼‰",
                    tag: "æ™ºå•†çˆ½æ–‡",
                    description: "ä¸æ˜¯æ— è„‘çˆ½ï¼Œæ˜¯â€œæ™ºå•†çˆ½â€ã€‚çº¿ç´¢åƒæ‹¼å›¾ä¸€æ ·æ‹¼ä¸Šå»ï¼Œé‚£ç§ç¬é—´ç†è§£çš„çˆ½ï¼Œæ¯”å‡çº§æ›´åˆºæ¿€ã€‚",
                    reviews: [
                        { avatar: "ğŸ‘¤", user: "æ¨ç†è¿·", content: "è¿™æœ¬çœŸçš„å…¨å‘˜æ™ºå•†åœ¨çº¿ï¼Œæ‰€ä»¥å¬çš„æ—¶å€™ä¹Ÿå¾—å¸¦ç€è„‘å­ã€‚", likes: 4567 },
                        { avatar: "ğŸ‘¤", user: "ç»†èŠ‚æ§", content: "é‡å¤æè¿°çš„åŠé«˜ä¸ç»¸ç¤¼å¸½éƒ½åˆ«æœ‰ä¸€ç•ªéŸµå‘³ã€‚", likes: 1234 },
                        { avatar: "ğŸ‘¤", user: "ä¼ç¬”æ”¶é›†è€…", content: "220ç§é­”è¯æœ‰å„è‡ªå¯¹åº”çš„æ‰®æ¼”æ–¹æ³•â€¦ä¸–ç•Œæ¶æ„å®å¤§ã€‚", likes: 2890 },
                        { avatar: "ğŸ‘¤", user: "æ™ºåŠ›å…š", content: "ä¼ç¬”â€¦æœ€åæˆåŠŸåœ†å›æ¥ã€‚", likes: 3456 }
                    ]
                }
            ]
        },
        {
            id: 2,
            persona: 'female-youth',
            title: "è¯¡ç§˜ä¹‹ä¸»ï½œè¿™æ˜¯å†™ç»™å¥³å­©çš„æµªæ¼«æˆé•¿è¯—",
            author: "çˆ±æ½œæ°´çš„ä¹Œè´¼",
            tags: ["å¥³æ€§è§’è‰²å‘å…‰", "æ°›å›´æ„Ÿç¾å­¦"],
            description: "åœ¨ç»´å¤šåˆ©äºšæ—¶ä»£çš„è¿·é›¾ä¸­ï¼Œæ¢ç´¢ç¥ç§˜å­¦ä¸è’¸æ±½æœ‹å…‹ï¼Œè§è¯ä¸€ä½æ™®é€šäººçš„å²è¯—æˆé•¿ã€‚",
            cover: "å¥³é’å¹´å°é¢.png",
            plays: "9875ä¸‡",
            badge: "ä¼šå‘˜",
            ranking: "æ–°å“æ¦œNo.3",
            videoFile: "ç”·é’å¹´-è§†é¢‘.mp4",
            albumTitle: "è¯¡ç§˜ä¹‹ä¸»",
            episodes: 1488,
            themeColor: "#cfa98b",
            highlights: [
                {
                    title: "æ¸©æŸ”çœŸå®çš„ä¸»è§’ï¼ˆå®‰å…¨æ„Ÿå‹ï¼‰",
                    tag: "å®‰å…¨æ„Ÿç”·ä¸»",
                    description: "ä¸æ˜¯æ²¹è…»å¤§ç”·ä¸»ã€ä¸æ˜¯å‚²æ…¢è£…é€¼ï¼Œè€Œæ˜¯æœ‰åº•çº¿ã€æœ‰åˆ†å¯¸ã€æœ‰è‰¯çŸ¥ã€‚å¥³é’å¹´ä»ä»–èº«ä¸Šçœ‹åˆ°â€œå–„è‰¯çš„åŠ›é‡â€ã€‚",
                    reviews: [
                        { avatar: "ğŸŒ¸", user: "å…‹è±æ©çš„å°ç²‰ä¸", content: "çœŸæ­£çš„ç°è±¡çº§å°è¯´â€¦å…‹è±æ©æ˜¯ä¸€ä¸ªä¸‰è§‚å¾ˆæ­£â€¦é¡ºç†æˆç« ä¸åœ£æ¯ã€‚", likes: 4321 },
                        { avatar: "ğŸŒ¸", user: "çˆ±åšæ¢¦çš„é±¼", content: "å“ªæ€•æ€‚å´æœ‰æ‹…å½“ï¼Œæ‹¼å‘½ç€ä¸å¿˜è®°è‡ªå·±çš„äººæ€§ã€‚", likes: 3129 }
                    ]
                },
                {
                    title: "å¥³æ€§è§’è‰²å¾ˆç¾ã€å¾ˆå¼ºã€å¾ˆç‹¬ç«‹",
                    tag: "ç‹¬ç«‹å¥³æ€§ç¾¤åƒ",
                    description: "å¥¥é»›ä¸½ç­‰è§’è‰²éƒ½ä¸æ˜¯å·¥å…·äººï¼Œæ¯ä¸ªäººéƒ½åœ¨è¡¨è¾¾â€œå¥³æ€§è‡ªèº«çš„åŠ›é‡â€ã€‚è¿™æ˜¯å¥³é’å¹´è¯»è€…ç‰¹åˆ«çˆ±çš„éƒ¨åˆ†ã€‚",
                    reviews: [
                        { avatar: "ğŸŒ¸", user: "å¥¥é»›ä¸½æ­£ä¹‰", content: "å¥¥é»›ä¸½æ˜¯æˆ‘è§è¿‡æœ€å®Œç¾çš„å¥³æ€§è§’è‰²ï¼Œå¥¹å°±å¦‚åŒå®çŸ³ä¸€æ ·çº¯å‡€ï¼Œé—ªé—ªå‘å…‰ï¼Œä¸”ä¸€ç‚¹ä¹Ÿä¸åˆºçœ¼ã€‚", likes: 5890 },
                        { avatar: "ğŸŒ¸", user: "ä¹¦ä¸­è‡ªæœ‰é¢œå¦‚ç‰", content: "é…è§’çš„æ•…äº‹é‡Œï¼Œæ¯ä¸ªäººéƒ½æ˜¯è‡ªå·±çš„ä¸»è§’ã€‚", likes: 2980 }
                    ]
                }
            ]
        },
        {
            id: 3,
            persona: 'male-middle-aged',
            title: "è¯¡ç§˜ä¹‹ä¸»ï½œä¸€éƒ¨è®²é€æˆäººä¸–ç•ŒæƒåŠ›è§„åˆ™çš„ç¡¬æ ¸æ•…äº‹",
            author: "çˆ±æ½œæ°´çš„ä¹Œè´¼",
            tags: ["åŠ›é‡æœ‰ä»£ä»·", "æˆå¹´äººè‡ªå¾‹è¯¾"],
            description: "åŠ›é‡çš„ä»£ä»·æ˜¯è´£ä»»ï¼Œåºåˆ—çš„æ™‹å‡æ˜¯æ·é”ã€‚ä¸€éƒ¨å…³äºæƒåŠ›ã€æ‰®æ¼”ä¸è‡ªæˆ‘åšå®ˆçš„æ·±åˆ»å¯“è¨€ã€‚",
            cover: "ç”·ä¸­å¹´å°é¢.png",
            plays: "8890ä¸‡",
            badge: "ä¼šå‘˜",
            ranking: "ç•…é”€æ¦œNo.2",
            videoFile: "ç”·é’å¹´-è§†é¢‘.mp4",
            albumTitle: "è¯¡ç§˜ä¹‹ä¸»",
            episodes: 1488,
            themeColor: "#4a4a4a",
            highlights: [
                 {
                    title: "åŠ›é‡æœ‰ä»£ä»·ï¼ˆæˆç†Ÿçš„æƒåŠ›è§‚ï¼‰",
                    tag: "æƒåŠ›ä»£ä»·",
                    description: "è¶Šå¾€ä¸Šï¼Œè¶Šå±é™©ï¼›è¶Šå¼ºå¤§ï¼Œè¶Šå®¹æ˜“è¿·å¤±ã€‚è¿™æ˜¯è¯¡ç§˜å†™ç»™æˆå¹´ç”·äººçš„ä¸€å°â€œæƒåŠ›å‘Šè¯«ä¹¦â€ã€‚",
                    reviews: [
                        { avatar: "ğŸ§", user: "èŒåœºè€é¸Ÿ", content: "è¶Šæ˜¯é«˜ä½ï¼Œè¶Šæ¥è¿‘ç–¯ç‹‚ã€‚", likes: 2109 },
                        { avatar: "ğŸ§", user: "äººæ€§è§‚å¯Ÿå®¶", content: "å“ªæ€•æ€‚å´æœ‰æ‹…å½“â€¦åšæŒç€è‡ªå·±åˆ¶å®šçš„åŸåˆ™ã€‚", likes: 1876 }
                    ]
                },
                {
                    title: "æ‰®æ¼”æ³• = æˆå¹´äººçš„è‡ªå¾‹è¯¾",
                    tag: "è‡ªå¾‹è¯¾",
                    description: "è¯¡ç§˜çš„â€œæ‰®æ¼”æ³•â€æ˜¯æœ€æˆç†Ÿçš„è®¾å®šä¹‹ä¸€ï¼šä½ èƒ½æ‰®æ¼”ä»»ä½•è§’è‰²ï¼Œä½†ä¸èƒ½å¿˜è®°è‡ªå·±æ˜¯è°ã€‚",
                    reviews: [
                        { avatar: "ğŸ§", user: "äººç”Ÿå¦‚æˆ", content: "æ€•æ­»æ€•ç–¼ä½†å‹‡æ•¢â€¦æ¸©æŸ”å–„è‰¯ä½†ä¸æ„šå–„ã€‚", likes: 1543 },
                        { avatar: "ğŸ§", user: "æ´å¯Ÿè€…", content: "èƒŒè´Ÿçš„å¤ªå¤šâ€¦è¿™æ¡è·¯æœ€ç»ˆåªæœ‰ä»–è‡ªå·±ã€‚", likes: 1322 }
                    ]
                }
            ]
        },
        {
            id: 4,
            persona: 'female-middle-aged',
            title: "è¯¡ç§˜ä¹‹ä¸»ï½œåœ¨å¤±åºçš„ä¸–ç•Œï¼Œå¦‚ä½•å®ˆæŠ¤ä¸€ä¸ªæ¸…é†’çš„è‡ªå·±",
            author: "çˆ±æ½œæ°´çš„ä¹Œè´¼",
            tags: ["å¥³æ€§è§’è‰²é—ªå…‰", "æƒ…ç»ªä»·å€¼"],
            description: "è§è¯å¥³æ€§è§’è‰²çš„ç‹¬ç«‹ä¸å…‰èŠ’ï¼Œæ„Ÿå—åœ¨å­¤ç‹¬ä¸è´£ä»»ä¸­çš„æ¯ä¸€æ¬¡æ¸©æŸ”è€Œåšå®šçš„é€‰æ‹©ã€‚",
            cover: "å¥³ä¸­å¹´å°é¢.png",
            plays: "7654ä¸‡",
            badge: "ä¼šå‘˜",
            ranking: "å£ç¢‘æ¦œNo.1",
            videoFile: "ç”·é’å¹´-è§†é¢‘.mp4",
            albumTitle: "è¯¡ç§˜ä¹‹ä¸»",
            episodes: 1488,
            themeColor: "#4b4269",
            highlights: [
                {
                    title: "å¥³æ€§è§’è‰²é—ªå…‰ï¼ˆåŠ›é‡ Ã— æ¸…é†’ Ã— æˆé•¿ï¼‰",
                    tag: "å¥³æ€§åŠ›é‡",
                    description: "è¯¡ç§˜é‡Œçš„å¥³æ€§è§’è‰²ä¸æ˜¯â€œè¢«ä¿æŠ¤è€…â€ï¼Œè€Œæ˜¯æœ‰æ˜ç¡®äººç”Ÿè½¨è¿¹ï¼Œæœ‰æˆé•¿ã€æœ‰æ™ºæ…§ã€æœ‰è¡ŒåŠ¨åŠ›çš„é‡è¦è§’è‰²ã€‚",
                    reviews: [
                        { avatar: "ä¼˜é›…", user: "äººé—´æ¸…é†’", content: "å¥¥é»›ä¸½æ˜¯æˆ‘è§è¿‡æœ€å®Œç¾çš„å¥³æ€§è§’è‰²ï¼Œå¥¹å°±å¦‚åŒå®çŸ³ä¸€æ ·çº¯å‡€ï¼Œé—ªé—ªå‘å…‰ï¼Œä¸”ä¸€ç‚¹ä¹Ÿä¸åˆºçœ¼ã€‚", likes: 3456 },
                        { avatar: "ä¼˜é›…", user: "ç‹¬ç«‹å¥³æ€§", content: "é…è§’çš„æ•…äº‹é‡Œï¼Œæ¯ä¸ªäººéƒ½æ˜¯è‡ªå·±çš„ä¸»è§’ã€‚", likes: 2890 }
                    ]
                },
                {
                    title: "ä¸»è§’çš„å–„è‰¯ä¸æ¸…é†’ï¼ˆæˆå¹´å¥³æ€§æœ€è®¤å¯çš„ç”·æ€§æ°”è´¨ï¼‰",
                    tag: "æˆç†Ÿç”·æ€§",
                    description: "ä»–ä¸ä¼šå¼ºåŠ¿ã€ä¸ä¼šæ²¹è…»ã€ä¸ä¼šæ»¥æƒï¼›ä½†ä¹Ÿä¸ä¼šæ‡¦å¼±ã€‚ä»–æ˜¯é‚£ç§â€œæ¸©æŸ”è€Œåšå®šâ€çš„äººã€‚",
                    reviews: [
                        { avatar: "ä¼˜é›…", user: "å“è´¨ç”Ÿæ´»å®¶", content: "å–œæ¬¢å…‹è±æ©â€¦æ‹¥æœ‰ç¾å¥½çš„å…±æƒ…æ„Ÿä¸åŒç†å¿ƒã€‚", likes: 2134 },
                        { avatar: "ä¼˜é›…", user: "çœ‹éç¹èŠ±", content: "å“ªæ€•æ€‚å´æœ‰æ‹…å½“â€¦åšæŒç€è‡ªå·±åˆ¶å®šçš„åŸåˆ™ã€‚", likes: 1879 }
                    ]
                }
            ]
        },
        {
            id: 5,
            persona: 'male-elderly',
            title: "è¯¡ç§˜ä¹‹ä¸»ï½œä¸€ä¸ªæ­£ç›´ã€ç¨³é‡ã€æœ‰åˆ†å¯¸çš„å“è´¨æ•…äº‹",
            author: "çˆ±æ½œæ°´çš„ä¹Œè´¼",
            tags: ["æ•…äº‹æ‰å®å¯ä¿¡", "ä¸»è§’æ­£ç›´"],
            description: "æ•…äº‹é€»è¾‘ä¸¥å¯†ï¼ŒèŠ‚å¥æ²‰ç¨³ï¼Œæ¼”ç»ä¸€ä¸ªæœ‰åŸåˆ™ã€æœ‰æ‹…å½“ã€æœ‰åº•çº¿çš„æˆç†Ÿç”·äººçš„å²è¯—ã€‚",
            cover: "https://images.unsplash.com/photo-1472190649224-495422e1b602?auto=format&fit=crop&w=400&q=80",
            plays: "5432ä¸‡",
            badge: "ä¼šå‘˜",
            ranking: "ç»å…¸æ¦œNo.5",
            videoFile: "ç”·é’å¹´-è§†é¢‘.mp4",
            albumTitle: "è¯¡ç§˜ä¹‹ä¸»",
            episodes: 1488,
            themeColor: "#3d3d3d",
            highlights: [
                {
                    title: "æ•…äº‹æ‰å®å¯ä¿¡ï¼ˆè€å¹´ç”¨æˆ·å¼ºè°ƒâ€œå¥½å¬ã€å¬å¾—æ‡‚â€ï¼‰",
                    tag: "å“è´¨æ•…äº‹",
                    description: "è€å¹´ç”¨æˆ·ä¸å–œæ¬¢ä¹±ä¸ƒå…«ç³Ÿçš„çˆ½æ–‡ï¼Œè¯¡ç§˜çš„æ•…äº‹é€»è¾‘ç¨³ã€èŠ‚å¥ç¨³ã€ç»†èŠ‚ç¨³ã€‚",
                    reviews: [
                        { avatar: "ğŸ‘´", user: "è€ä¹¦è¿·", content: "å‰§æƒ…ç¯ç¯ç›¸æ‰£ã€é€»è¾‘æ¸…æ™°ã€‚", likes: 987 },
                        { avatar: "ğŸ‘´", user: "é€€ä¼‘å¼ æ•™æˆ", content: "ç»“æ„å®å¤§äº•ç„¶æœ‰åºâ€¦ä¸€è·¯è¯»ä¸‹æ¥æ¸å…¥ä½³å¢ƒæ¬²ç½¢ä¸èƒ½ã€‚", likes: 876 }
                    ]
                },
                 {
                    title: "ä¸»è§’æ­£ç›´ã€æœ‰åˆ†å¯¸ã€ä¸ä¹±æ¥",
                    tag: "æ­£ç›´å“æ ¼",
                    description: "ç”·è€å¹´ç”¨æˆ·å–œæ¬¢æœ‰æ‹…å½“ã€æœ‰åˆ†å¯¸ã€æœ‰åº•çº¿çš„è§’è‰²ã€‚ä»–ä»¬åœ¨ä¸»è§’èº«ä¸Šçœ‹åˆ°â€œé‚£ä¸ªå¹´ä»£çš„ç”·äººå‘³â€ã€‚",
                    reviews: [
                        { avatar: "ğŸ‘´", user: "é™ˆå¹´è€èŒ¶", content: "å…‹è±æ©æ˜¯ä¸€ä¸ªä¸‰è§‚å¾ˆæ­£â€¦é¡ºç†æˆç« ä¸åœ£æ¯ã€‚", likes: 1123 },
                        { avatar: "ğŸ‘´", user: "å²æœˆç•™å£°", content: "å“ªæ€•æ€‚å´æœ‰æ‹…å½“â€¦åšæŒç€è‡ªå·±åˆ¶å®šçš„åŸåˆ™ã€‚", likes: 1056 }
                    ]
                }
            ]
        },
        {
            id: 6,
            persona: 'female-elderly',
            title: "è¯¡ç§˜ä¹‹ä¸»ï½œé€‚åˆé™é™å¬çš„æ¸©æŸ”æ•…äº‹ï¼Œåƒé™ªä¼´",
            author: "çˆ±æ½œæ°´çš„ä¹Œè´¼",
            tags: ["æ¸©æŸ”å–„è‰¯çš„ä¸»è§’", "èŠ‚å¥ç¨³"],
            description: "æ•…äº‹æ¸©æŸ”ï¼ŒèŠ‚å¥å¹³ç¨³ï¼Œå£°éŸ³æœ‰æ¸©åº¦ã€‚é€‚åˆåœ¨ç¡å‰ã€æ•£æ­¥æ—¶ï¼Œé™é™æ„Ÿå—é™ªä¼´çš„åŠ›é‡ã€‚",
            cover: "https://images.unsplash.com/photo-1547635289-3544a83b1a72?auto=format&fit=crop&w=400&q=80",
            plays: "4321ä¸‡",
            badge: "ä¼šå‘˜",
            ranking: "æ²»æ„ˆæ¦œNo.1",
            videoFile: "ç”·é’å¹´-è§†é¢‘.mp4",
            albumTitle: "è¯¡ç§˜ä¹‹ä¸»",
            episodes: 1488,
            themeColor: "#8c7a6b",
            highlights: [
                {
                    title: "æ¸©æŸ”å–„è‰¯çš„ä¸»è§’ï¼ˆé€‚åˆå¥³è€å¹´çš„æƒ…ç»ªå…±é¸£ï¼‰",
                    tag: "å–„è‰¯ä¸»è§’",
                    description: "å¥³è€å¹´è¯»è€…æœ€å–œæ¬¢â€œå¿ƒå¥½ã€æœ‰åˆ†å¯¸ã€æœ‰æ‹…å½“â€çš„è§’è‰²ã€‚è¯¡ç§˜ä¸»è§’æ˜¯é‚£ç§è®©äººæ”¾å¿ƒã€è®©äººå¿ƒç–¼ã€è®©äººå°Šæ•¬çš„å­©å­ã€‚",
                    reviews: [
                        { avatar: "ğŸ‘µ", user: "çˆ±å¬æ•…äº‹çš„ç‹å¥¶å¥¶", content: "ä¸»è§’æ€§æ ¼ä¹Ÿå¾ˆæ£’ï¼Œä¸åœ£æ¯ä¹Ÿä¸æ— è„‘æ€æˆ®ï¼Œæœ‰å°æˆ‘ä¹Ÿæœ‰å¤§çˆ±ã€‚", likes: 876 },
                        { avatar: "ğŸ‘µ", user: "å¤•é˜³çº¢", content: "å–œæ¬¢å…‹è±æ©â€¦æ‹¥æœ‰ç¾å¥½çš„å…±æƒ…æ„Ÿä¸åŒç†å¿ƒã€‚", likes: 765 }
                    ]
                },
                {
                    title: "æ•…äº‹æ¸©æŸ”ã€èŠ‚å¥ç¨³ã€ä¸åµä¸ä¹±",
                    tag: "èŠ‚å¥å¹³ç¨³",
                    description: "æ•…äº‹é€»è¾‘æ¸…æ™°ã€èŠ‚å¥å¹³è¡¡ï¼Œä¸åƒå¾ˆå¤šç„å¹»é‚£æ ·ä¹±ä¸ƒå…«ç³Ÿï¼Œéå¸¸é€‚åˆæ…¢æ…¢å¬ã€‚",
                     reviews: [
                        { avatar: "ğŸ‘µ", user: "æé˜¿å§¨", content: "å‰§æƒ…ç¯ç¯ç›¸æ‰£ã€é€»è¾‘æ¸…æ™°ã€‚", likes: 654 },
                        { avatar: "ğŸ‘µ", user: "æ—¶å…‰æ¼«æ­¥", content: "ä¸€è·¯è¯»ä¸‹æ¥æ¸å…¥ä½³å¢ƒã€‚", likes: 543 }
                    ]
                }
            ]
        }
    ];

    // åˆ—è¡¨å¡ç‰‡æ•°æ® (ä¿æŒä¸å˜)
    const listCards = [
        { title: "é•¿è°ˆÂ·è„±ä¸èŠ±", desc: "ä¸äººé•¿è°ˆï¼Œå’Œåˆ«äººä¸Šä¸ªè¯·æ•™ï¼Œå°±æ˜¯æœ€å¥½çš„å­¦ä¹ ", reco: "100%", plays: "9.3ä¸‡", cover: "https://images.unsplash.com/photo-1573496359142-b8d87734a5a2?auto=format&fit=crop&w=200&q=80" },
        { title: "ä»Šæ—¥åœ†æ¡Œæ´¾", desc: "å¤šè§’åº¦è§£è¯»ï¼Œæ‹“å±•è®¤çŸ¥è¾¹ç•Œ", reco: "87%", plays: "472ä¸‡", cover: "https://images.unsplash.com/photo-1557426272-fc759fdf7a8d?auto=format&fit=crop&w=200&q=80", badge: "NEW POINTS" },
        { title: "è‘£æ…§ç¦ï¼šæ­£å¿µå†¥æƒ³è¯¾", desc: "æœŸå¦ç¦æ­£å¿µå†¥æƒ³ï¼ŒåŠ©ä½ ä¸€å¤œå¥½çœ ", reco: "", plays: "440ä¸‡", cover: "https://images.unsplash.com/photo-1506126613408-eca07ce68773?auto=format&fit=crop&w=200&q=80", badge: "SVIP" }
    ];

    let currentBook = null;
    let carouselInterval = null;
    let autoMode = true;
    let highlightCarouselInterval = null;
    let currentHighlightIndex = 0;
 
     document.addEventListener('DOMContentLoaded', function() {
         // åˆå§‹åŒ–åˆ—è¡¨å¡ç‰‡
         const listCardsContainer = document.getElementById('list-cards');
         if (listCardsContainer) {
             // æ¸…ç©ºï¼Œé˜²æ­¢é‡å¤æ¸²æŸ“
             listCardsContainer.innerHTML = '';
             listCards.forEach(item => {
                 const card = document.createElement('div');
                 card.className = 'list-card';
                 card.innerHTML = `
                     <div class="list-card-cover" style="background-image: url('${item.cover}')">
                         ${item.badge ? `<div style="position:absolute; top:4px; left:4px; background:#ffd700; color:#333; font-size:8px; padding:2px 4px; border-radius:3px; font-weight:bold;">${item.badge}</div>` : ''}
                     </div>
                     <div class="list-card-info">
                         <div class="list-card-title">${item.title}</div>
                         <div class="list-card-desc">${item.desc}</div>
                         <div style="display:flex; gap:8px; align-items:center; margin-top:4px;">
                             ${item.reco ? `<span style="font-size:11px; color:#666;">æ¨èå€¼${item.reco}</span>` : ''}
                             <span style="font-size:11px; color:#999;"><i class="fas fa-play-circle" style="margin-right:3px;"></i>${item.plays}</span>
                         </div>
                     </div>
                 `;
                 listCardsContainer.appendChild(card);
             });
         }
 
         const feedGrid = document.getElementById('feed-grid');
          
          if (feedGrid) {
              // æ¸…ç©ºç°æœ‰grid
              feedGrid.innerHTML = '';
              books.forEach(book => {
                  try {
                      const card = createGridCard(book);
                      feedGrid.appendChild(card);
                  } catch (error) {
                      console.error('Error creating card for book:', book, error);
                  }
              });
          }
     });
     
     function createGridCard(book) {
         const card = document.createElement('div');
         card.className = 'grid-card';
         
         // ç¡®ä¿ tags å­˜åœ¨ä¸”æ˜¯æ•°ç»„
         const tags = Array.isArray(book.tags) ? book.tags : [];
         
         card.innerHTML = `
             <div class="grid-card-cover" style="background-image: url('${book.cover}')">
                <div class="card-badge" style="background: ${book.badge === 'ä¼šå‘˜' ? 'var(--primary)' : '#ffd700'}; color: ${book.badge === 'ä¼šå‘˜' ? '#fff' : '#333'};">${book.badge}</div>
             </div>
             <div class="grid-card-info">
                 <div class="grid-card-title">${book.title}</div>
                 <div>
                    <div class="grid-card-tags">
                        ${tags.map(tag => `<span class="grid-tag">${tag}</span>`).join('')}
                    </div>
                    <div class="grid-card-meta">
                        <i class="fas fa-play-circle" style="margin-right:3px; color: #999;"></i>
                        <span style="color: #999;">${book.plays || 'æœªçŸ¥'}</span>
                    </div>
                 </div>
             </div>
         `;
         card.onclick = () => openPlayer(book);
         return card;
     }

     // æ‰“å¼€æ’­æ”¾å™¨
     function openPlayer(book) {
         currentBook = book;
         const player = document.getElementById('player');
         
         // 1. è®¾ç½®è§†é¢‘
         const video = document.getElementById('immersive-video');
         if (book.videoFile) {
             video.src = book.videoFile;
             video.play().catch(e => console.error("è§†é¢‘æ’­æ”¾å¤±è´¥:", e));
         }

         // 2. è®¾ç½®äº®ç‚¹é¡µ
         const highlightsPanel = document.getElementById('highlights-panel');
         const highlightsContent = document.getElementById('highlights-panel-content');
         const highlightsBarTitle = document.getElementById('highlights-bar-title');
         const dotsContainer = document.getElementById('highlights-carousel-dots');

         // 2.1 è®¾ç½®èƒŒæ™¯è‰²
         highlightsPanel.style.backgroundColor = book.themeColor || '#181818';
         document.getElementById('player-bar-title').innerText = book.albumTitle || book.title;
         document.getElementById('player-bar-desc').innerText = book.description || ''; // è®¾ç½®æè¿°

         // 2.2 å¡«å……å†…å®¹
         highlightsContent.innerHTML = '';
         dotsContainer.innerHTML = ''; // æ¸…ç©ºåˆ†é¡µç‚¹
         if (book.highlights) {
            book.highlights.forEach((highlight, index) => {
                // åˆ›å»º slide
                const slide = document.createElement('div');
                slide.className = 'highlight-slide';
                slide.innerHTML = `
                    <div class="slide-tag">${highlight.tag}</div>
                    <div class="slide-title">${highlight.title}</div>
                    <div class="slide-review-card">
                        <div class="review-author">
                            <div class="avatar">${highlight.reviews[0].avatar}</div>
                            <div class="username">${highlight.reviews[0].user}</div>
                        </div>
                        <div class="review-text">â€œ${highlight.reviews[0].content}â€</div>
                    </div>
                `;
                highlightsContent.appendChild(slide);

                // åˆ›å»ºåˆ†é¡µç‚¹
                const dot = document.createElement('div');
                dot.className = 'dot';
                dot.onclick = () => showHighlightSlide(index);
                dotsContainer.appendChild(dot);
            });
         }

         // 3. é‡ç½®åˆ°è§†é¢‘tabå¹¶æ‰“å¼€æ’­æ”¾å™¨
         switchImmersiveTab('video');
         player.classList.add('active');
         startHighlightCarousel(); // æ‰“å¼€æ’­æ”¾å™¨æ—¶å¼€å§‹è½®æ’­
     }

     // å…³é—­æ’­æ”¾å™¨
     function closePlayer() {
         document.getElementById('player').classList.remove('active');
         const video = document.getElementById('immersive-video');
         video.pause();
         stopHighlightCarousel(); // å…³é—­æ—¶åœæ­¢è½®æ’­
     }
     
     // åˆ‡æ¢æ²‰æµ¸é¡µçš„Tab
     function switchImmersiveTab(tabName) {
        const player = document.getElementById('player');
        const videoPanel = document.getElementById('video-panel');
        const highlightsPanel = document.getElementById('highlights-panel');
        const tabVideo = document.getElementById('tab-video');
        const tabHighlights = document.getElementById('tab-highlights');
        const video = document.getElementById('immersive-video');
        const bottomBar = document.querySelector('.player-bottom-bar');

        if (tabName === 'video') {
            videoPanel.classList.add('active');
            highlightsPanel.classList.remove('active');
            tabVideo.classList.add('active');
            tabHighlights.classList.remove('active');
            bottomBar.style.display = 'flex';
            video.play().catch(e => {}); // åˆ‡æ¢å›æ¥æ—¶å°è¯•æ’­æ”¾
            stopHighlightCarousel(); // åœæ­¢è½®æ’­
        } else {
            videoPanel.classList.remove('active');
            highlightsPanel.classList.add('active');
            tabVideo.classList.remove('active');
            tabHighlights.classList.add('active');
            bottomBar.style.display = 'none';
            video.pause(); // åˆ‡æ¢èµ°æ—¶æš‚åœè§†é¢‘
            startHighlightCarousel(); // å¼€å§‹è½®æ’­
        }
     }

     // --- äº®ç‚¹è½®æ’­é€»è¾‘ ---
     function startHighlightCarousel() {
        if (highlightCarouselInterval) clearInterval(highlightCarouselInterval);
        currentHighlightIndex = 0;
        showHighlightSlide(currentHighlightIndex);
        
        highlightCarouselInterval = setInterval(() => {
            const totalSlides = currentBook?.highlights?.length || 0;
            if (totalSlides > 1) {
                currentHighlightIndex = (currentHighlightIndex + 1) % totalSlides;
                showHighlightSlide(currentHighlightIndex);
            }
        }, 5000); // 5ç§’åˆ‡æ¢ä¸€æ¬¡
     }

     function stopHighlightCarousel() {
        if (highlightCarouselInterval) {
            clearInterval(highlightCarouselInterval);
            highlightCarouselInterval = null;
        }
     }

     function showHighlightSlide(index) {
        const track = document.getElementById('highlights-panel-content');
        const dots = document.querySelectorAll('#highlights-carousel-dots .dot');
        const totalSlides = dots.length;

        if (index >= 0 && index < totalSlides) {
            currentHighlightIndex = index;
            track.style.transform = `translateX(-${index * 100}%)`;
            
            dots.forEach((dot, i) => {
                dot.classList.toggle('active', i === index);
            });
        }
     }
     
     // æ˜¾ç¤ºåˆé›†åˆ—è¡¨ (ä¿ç•™å¼¹çª—é€»è¾‘)
     function showEpisodeList() {
         if (!currentBook || !currentBook.episodes) {
             alert('æš‚æ— åˆé›†ä¿¡æ¯');
             return;
         }
         const episodeListText = currentBook.episodes.join('\n');
         alert('åˆé›†åˆ—è¡¨ï¼š\n' + episodeListText);
     }
 
     // è½®æ’­é€»è¾‘ (ä¸å†éœ€è¦ï¼Œä½†ä¿ç•™å‡½æ•°ä»¥é˜²å…¶ä»–åœ°æ–¹è°ƒç”¨)
     function setupCarousel(images) {
        const track = document.getElementById('carousel-track');
        track.innerHTML = '';
        images.forEach(img => {
            const div = document.createElement('div');
            div.className = 'carousel-item comic-filter';
            div.style.backgroundImage = `url('${img}')`;
            track.appendChild(div);
        });

        let index = 0;
        clearInterval(carouselInterval);
        
        // è‡ªåŠ¨è½®æ’­
        carouselInterval = setInterval(() => {
            if(!autoMode) return;
            index = (index + 1) % images.length;
            track.style.transform = `translateX(-${index * 100}%)`;
        }, 3000); // 3ç§’åˆ‡æ¢ä¸€å¼ 
    }

    // åˆ‡æ¢äº¤äº’æ¨¡å¼
    function toggleAutoMode() {
        autoMode = !autoMode;
        const txt = document.getElementById('mode-text');
        txt.innerText = autoMode ? "è‡ªåŠ¨æ¼”ç¤ºä¸­" : "æ‰‹åŠ¨æµè§ˆ";
        txt.parentElement.style.background = autoMode ? "rgba(0,0,0,0.6)" : "var(--primary)";
    }

    // Tab åˆ‡æ¢é€»è¾‘
    // function switchImmersiveTab(type) { ... }

    // è·³è½¬é€»è¾‘
    function goToAlbum() {
        // ç®€å•çš„äº¤äº’åé¦ˆ
        const btn = document.querySelector('.p-listen-full');
        btn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> è·³è½¬ä¸­...';
        setTimeout(() => {
            alert(`æ­£åœ¨å‰å¾€ã€Š${currentBook.title}ã€‹ä¸“è¾‘å…¨é›†é¡µé¢...`);
            btn.innerHTML = 'ç•…å¬å…¨é›† <i class="fas fa-angle-right"></i>';
        }, 800);
    }

    // åˆå§‹åŒ–æ—¶é»˜è®¤é€‰ä¸­ç¬¬ä¸€ä¸ªTab
    // (åœ¨çœŸå®ç¯å¢ƒä¸­éœ€è¦åœ¨ openPlayer æ—¶è°ƒç”¨ä¸€æ¬¡ ensure active state)

</script>
</body>
</html>